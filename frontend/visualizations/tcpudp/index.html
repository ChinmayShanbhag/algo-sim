<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TCP vs UDP Comparison</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div id="container">
        <nav class="top-nav">
            <a href="../../index.html" class="back-link">‚Üê Back to Home</a>
            <button id="theme-toggle" class="theme-toggle" aria-label="Toggle theme">
                <span class="theme-icon">üåô</span>
            </button>
        </nav>
        <h1>TCP vs UDP: Protocol Comparison</h1>
        
        <div class="instruction-banner">
            <p>üìù <strong>How to use:</strong> Enter packet data ‚Üí Click "Send to Both Protocols" ‚Üí Watch TCP and UDP handle the same data differently</p>
        </div>
        
        <div id="controls">
            <div class="control-group">
                <h3>Connection Management</h3>
                <div class="controls-row">
                    <button id="connect-btn" class="connect-button">üîå Establish TCP Connection</button>
                    <button id="disconnect-btn" class="disconnect-button" disabled>üîå Close TCP Connection</button>
                </div>
                <p class="control-help">TCP requires a 3-way handshake (SYN ‚Üí SYN-ACK ‚Üí ACK) before data transmission. UDP is connectionless.</p>
            </div>
            
            <div class="control-group">
                <h3>Send Packets</h3>
                <div class="controls-row">
                    <input type="text" id="packet-data" placeholder="Enter packet data (e.g., 'Hello World')" class="input-field">
                    <button id="send-btn" class="send-button">üì§ Send to Both Protocols</button>
                    <button id="reset-btn" class="reset-button">Reset</button>
                </div>
                <p class="control-help">Sends the same data via both TCP and UDP simultaneously to compare behavior</p>
            </div>
            
            <div class="control-group">
                <h3>Packet Loss Rate: <span id="loss-rate-display">20%</span></h3>
                <input type="range" id="loss-rate-slider" min="0" max="100" value="20" step="5">
                <p class="slider-help">Adjust to simulate network conditions (0% = perfect network, 100% = all packets lost)</p>
            </div>
        </div>

        <div class="main-content">
            <div class="protocols-wrapper">
                <div class="protocols-container">
                <!-- TCP Protocol -->
                <div class="protocol-section tcp-section">
                    <h2>üîí TCP (Transmission Control Protocol)</h2>
                    <div class="protocol-features">
                        <span class="feature-badge">‚úÖ Reliable</span>
                        <span class="feature-badge">‚úÖ Ordered</span>
                        <span class="feature-badge">‚úÖ Connection-Based</span>
                        <span class="feature-badge">‚ö†Ô∏è Slower</span>
                    </div>
                    
                    <div class="visualization-area">
                        <div class="endpoint">Sender</div>
                        <div class="packet-lane" id="tcp-lane"></div>
                        <div class="endpoint">Receiver</div>
                    </div>
                    
                    <div class="packets-list">
                        <h4>Recent Packets</h4>
                        <div id="tcp-packets"></div>
                    </div>
                    
                    <div class="stats-panel">
                        <h4>üìä Statistics</h4>
                        <div class="stat-row">
                            <span>Sent:</span>
                            <span id="tcp-sent" class="stat-value">0</span>
                        </div>
                        <div class="stat-row">
                            <span>Delivered:</span>
                            <span id="tcp-delivered" class="stat-value">0</span>
                        </div>
                        <div class="stat-row">
                            <span>Retried:</span>
                            <span id="tcp-retried" class="stat-value">0</span>
                        </div>
                        <div class="stat-row">
                            <span>Lost (Max Retries):</span>
                            <span id="tcp-lost" class="stat-value">0</span>
                        </div>
                        <div class="stat-row">
                            <span>ACKs:</span>
                            <span id="tcp-acks" class="stat-value">0</span>
                        </div>
                        <div class="stat-row">
                            <span>Delivery Rate:</span>
                            <span id="tcp-rate" class="stat-value">0%</span>
                        </div>
                    </div>
                </div>

                <!-- UDP Protocol -->
                <div class="protocol-section udp-section">
                    <h2>‚ö° UDP (User Datagram Protocol)</h2>
                    <div class="protocol-features">
                        <span class="feature-badge">‚ùå Unreliable</span>
                        <span class="feature-badge">‚ùå Unordered</span>
                        <span class="feature-badge">‚úÖ Connectionless</span>
                        <span class="feature-badge">‚úÖ Faster</span>
                    </div>
                    
                    <div class="visualization-area">
                        <div class="endpoint">Sender</div>
                        <div class="packet-lane" id="udp-lane"></div>
                        <div class="endpoint">Receiver</div>
                    </div>
                    
                    <div class="packets-list">
                        <h4>Recent Packets</h4>
                        <div id="udp-packets"></div>
                    </div>
                    
                    <div class="stats-panel">
                        <h4>üìä Statistics</h4>
                        <div class="stat-row">
                            <span>Sent:</span>
                            <span id="udp-sent" class="stat-value">0</span>
                        </div>
                        <div class="stat-row">
                            <span>Delivered:</span>
                            <span id="udp-delivered" class="stat-value">0</span>
                        </div>
                        <div class="stat-row">
                            <span>Lost:</span>
                            <span id="udp-lost" class="stat-value">0</span>
                        </div>
                        <div class="stat-row">
                            <span>No Retries:</span>
                            <span class="stat-value">N/A</span>
                        </div>
                        <div class="stat-row">
                            <span>Delivery Rate:</span>
                            <span id="udp-rate" class="stat-value">0%</span>
                        </div>
                    </div>
                </div>
            </div>
            </div>

            <!-- Explanation Panel - Now at Bottom -->
            <div id="explanation-panel">
                <h2>TCP vs UDP: Key Differences</h2>
                <div class="explanation-content">
                    <h3>When to Use Each?</h3>
                    
                    <h4>Use TCP When:</h4>
                    <ul>
                        <li><strong>Data integrity is critical</strong> (file transfers, emails, web pages)</li>
                        <li><strong>Order matters</strong> (database transactions, APIs)</li>
                        <li><strong>You need guaranteed delivery</strong> (banking, e-commerce)</li>
                        <li>Examples: HTTP/HTTPS, FTP, SMTP, SSH</li>
                    </ul>

                    <h4>Use UDP When:</h4>
                    <ul>
                        <li><strong>Speed is more important than reliability</strong> (streaming, gaming)</li>
                        <li><strong>Small data bursts</strong> (DNS queries)</li>
                        <li><strong>Real-time communication</strong> (VoIP, video conferencing)</li>
                        <li><strong>Multicast/broadcast needed</strong> (network discovery)</li>
                        <li>Examples: DNS, VoIP, Video Streaming, Online Gaming</li>
                    </ul>

                    <h3>Feature Comparison</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>Feature</th>
                                <th>TCP</th>
                                <th>UDP</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Connection</td>
                                <td>‚úÖ Connection-oriented (3-way handshake)</td>
                                <td>‚ùå Connectionless</td>
                            </tr>
                            <tr>
                                <td>Reliability</td>
                                <td>‚úÖ Guaranteed delivery with ACKs</td>
                                <td>‚ùå No guarantees</td>
                            </tr>
                            <tr>
                                <td>Ordering</td>
                                <td>‚úÖ Packets arrive in order</td>
                                <td>‚ùå May arrive out of order</td>
                            </tr>
                            <tr>
                                <td>Error Checking</td>
                                <td>‚úÖ Extensive error checking & correction</td>
                                <td>‚ö†Ô∏è Basic checksum only</td>
                            </tr>
                            <tr>
                                <td>Speed</td>
                                <td>‚ö†Ô∏è Slower (overhead from reliability)</td>
                                <td>‚úÖ Faster (minimal overhead)</td>
                            </tr>
                            <tr>
                                <td>Retransmission</td>
                                <td>‚úÖ Automatic retries on packet loss</td>
                                <td>‚ùå No retries</td>
                            </tr>
                            <tr>
                                <td>Flow Control</td>
                                <td>‚úÖ Yes (prevents overwhelming receiver)</td>
                                <td>‚ùå No</td>
                            </tr>
                            <tr>
                                <td>Congestion Control</td>
                                <td>‚úÖ Yes (adjusts to network conditions)</td>
                                <td>‚ùå No</td>
                            </tr>
                            <tr>
                                <td>Header Size</td>
                                <td>20-60 bytes (larger)</td>
                                <td>8 bytes (smaller)</td>
                            </tr>
                            <tr>
                                <td>Broadcasting</td>
                                <td>‚ùå Not supported</td>
                                <td>‚úÖ Supported</td>
                            </tr>
                        </tbody>
                    </table>

                    <h3>Real-World Examples</h3>
                    <div class="example-box">
                        <h4>TCP: Web Browsing (HTTP/HTTPS)</h4>
                        <p>When you load a website, every image, CSS file, and script must arrive completely and in order. TCP ensures nothing is missing.</p>
                    </div>

                    <div class="example-box">
                        <h4>UDP: Video Call (Zoom, Teams)</h4>
                        <p>In a video call, if a few frames drop, it's better to continue than wait for retransmission. UDP prioritizes speed over perfection.</p>
                    </div>

                    <div class="example-box">
                        <h4>TCP: File Download</h4>
                        <p>Downloading a file requires every byte to arrive correctly. TCP's reliability ensures the file isn't corrupted.</p>
                    </div>

                    <div class="example-box">
                        <h4>UDP: Online Gaming</h4>
                        <p>In fast-paced games, player positions update constantly. Old position data is useless, so UDP's speed is preferred.</p>
                    </div>

                    <h3>Try It:</h3>
                    <ol>
                        <li>Send TCP packets ‚Üí See how they're acknowledged and retried if lost</li>
                        <li>Send UDP packets ‚Üí Notice some may be lost with no retry</li>
                        <li>Adjust packet loss rate ‚Üí See how TCP maintains reliability</li>
                        <li>Compare delivery rates ‚Üí TCP stays near 100%, UDP varies</li>
                    </ol>

                    <h3>üîß Real-World Implementation (OS Kernel Level)</h3>
                    <div class="backend-section">
                        <p><strong>Note:</strong> This shows how TCP and UDP actually work in operating systems (Linux, Windows, etc.), not how we simulate them in this demo.</p>
                        
                        <h4>TCP: Reliable Transport Protocol</h4>
                        
                        <div class="algorithm-impl">
                            <h5>TCP Connection State Machine</h5>
                            <pre><code>STATES:
    CLOSED       ‚Üí No connection
    LISTEN       ‚Üí Server waiting for connection
    SYN_SENT     ‚Üí Client sent SYN, waiting for SYN-ACK
    SYN_RECEIVED ‚Üí Server received SYN, sent SYN-ACK
    ESTABLISHED  ‚Üí Connection active, data transfer
    FIN_WAIT_1   ‚Üí Sent FIN, waiting for ACK
    FIN_WAIT_2   ‚Üí Received ACK, waiting for FIN
    TIME_WAIT    ‚Üí Waiting for 2*MSL before full close
    CLOSE_WAIT   ‚Üí Received FIN, waiting for app to close
    LAST_ACK     ‚Üí Sent FIN, waiting for ACK
    CLOSING      ‚Üí Both sides closing simultaneously

STRUCTURE TCPControlBlock:
    localIP: IPAddress
    localPort: Port
    remoteIP: IPAddress
    remotePort: Port
    state: State
    
    // Sequence numbers
    sendNext: Integer      // Next seq number to send
    sendUnack: Integer     // Oldest unacknowledged
    receiveNext: Integer   // Next expected seq number
    
    // Buffers
    sendBuffer: CircularBuffer   // Data waiting to send
    receiveBuffer: CircularBuffer // Out-of-order packets
    
    // Timers
    retransmitTimer: Timer        // Retry lost packets
    persistTimer: Timer           // Zero-window probing
    keepAliveTimer: Timer         // Connection alive check
    timeWaitTimer: Timer          // 2MSL wait
    
    // Congestion control
    cwnd: Integer          // Congestion window
    ssthresh: Integer      // Slow start threshold
    rtt: Duration          // Round-trip time
    rto: Duration          // Retransmission timeout</code></pre>
                        </div>

                        <div class="algorithm-impl">
                            <h5>Real TCP Send Operation (Kernel)</h5>
                            <pre><code>// Application calls: send(socket, data, length)
FUNCTION TCP_Send(tcb, data):
    // 1. Copy data to send buffer
    sendBuffer.append(data)
    
    // 2. Segment data into packets (MSS = ~1460 bytes)
    WHILE sendBuffer.hasData() AND cwnd allows sending:
        segment = sendBuffer.read(min(MSS, cwnd - inFlight))
        
        // 3. Build TCP packet
        packet = {
            srcPort: tcb.localPort,
            dstPort: tcb.remotePort,
            seqNum: tcb.sendNext,
            ackNum: tcb.receiveNext,
            flags: ACK,  // Or PSH for urgent data
            window: tcb.receiveWindow,
            checksum: calculateChecksum(packet),
            data: segment
        }
        
        // 4. Send to IP layer (non-blocking!)
        IP_Send(packet, tcb.remoteIP)
        
        // 5. Start retransmission timer if not already running
        IF retransmitTimer NOT running THEN
            retransmitTimer.start(tcb.rto)
        END IF
        
        // 6. Update sequence number
        tcb.sendNext += length(segment)
        
        // 7. Store in retransmission queue
        retransmitQueue.add(packet)
    END WHILE
END FUNCTION

KEY: No blocking! Kernel handles everything asynchronously</code></pre>
                        </div>

                        <div class="algorithm-impl">
                            <h5>Real TCP Receive & ACK (Kernel Event-Driven)</h5>
                            <pre><code>// Triggered when packet arrives from network
FUNCTION TCP_Receive_Interrupt(packet):
    tcb = findConnection(packet.srcIP, packet.srcPort)
    
    // 1. Validate checksum
    IF NOT validateChecksum(packet) THEN
        DROP packet
        RETURN
    END IF
    
    // 2. Check sequence number
    IF packet.seqNum == tcb.receiveNext THEN
        // In-order packet
        receiveBuffer.append(packet.data)
        tcb.receiveNext += length(packet.data)
        
        // Deliver to application
        wakeup_process(tcb.waitingProcess)
        
        // Check if buffered packets are now in order
        WHILE receiveBuffer.has(tcb.receiveNext):
            nextPacket = receiveBuffer.get(tcb.receiveNext)
            deliverToApp(nextPacket)
            tcb.receiveNext += length(nextPacket)
        END WHILE
    ELSE IF packet.seqNum > tcb.receiveNext THEN
        // Out-of-order packet - buffer it
        receiveBuffer.store(packet)
    ELSE
        // Duplicate packet - ignore but still ACK
    END IF
    
    // 3. Send ACK immediately (delayed ACK optimization)
    send_ack(tcb, tcb.receiveNext)
    
    // 4. If ACK received, remove from retransmit queue
    IF packet.flags.ACK THEN
        remove_acknowledged(packet.ackNum)
        retransmitTimer.stop()
        updateRTT(packet)  // Adjust RTO based on actual RTT
    END IF
END FUNCTION

KEY: Interrupt-driven, not polling!</code></pre>
                        </div>

                        <div class="algorithm-impl">
                            <h5>TCP Retransmission (Timer Event)</h5>
                            <pre><code>// Triggered when retransmission timer expires
FUNCTION TCP_Retransmit_Timeout():
    // 1. Get oldest unacknowledged packet
    packet = retransmitQueue.first()
    
    // 2. Resend packet
    IP_Send(packet, tcb.remoteIP)
    
    // 3. Double RTO (exponential backoff)
    tcb.rto = min(tcb.rto * 2, MAX_RTO)  // Max 64 seconds
    
    // 4. Restart timer
    retransmitTimer.start(tcb.rto)
    
    // 5. Congestion control: Enter slow start
    tcb.ssthresh = cwnd / 2
    tcb.cwnd = 1  // Reset to 1 MSS
END FUNCTION

KEY: TCP never gives up! Retries until connection breaks or app closes socket</code></pre>
                        </div>

                        <h4>UDP: Simple, Stateless Protocol</h4>
                        
                        <div class="algorithm-impl">
                            <h5>Real UDP Send (Kernel)</h5>
                            <pre><code>// Application calls: sendto(socket, data, dest_addr)
FUNCTION UDP_Send(data, destIP, destPort):
    // 1. Build UDP packet (NO connection state!)
    packet = {
        srcPort: socket.localPort,
        dstPort: destPort,
        length: length(data) + 8,  // 8-byte header
        checksum: calculateChecksum(data),
        data: data
    }
    
    // 2. Send to IP layer immediately
    IP_Send(packet, destIP)
    
    // 3. Return immediately - NO retries, NO ACKs, NO timers!
    RETURN SUCCESS
END FUNCTION

KEY: Fire-and-forget! Kernel doesn't track anything</code></pre>
                        </div>

                        <div class="algorithm-impl">
                            <h5>Real UDP Receive (Kernel Event-Driven)</h5>
                            <pre><code>// Triggered when packet arrives
FUNCTION UDP_Receive_Interrupt(packet):
    // 1. Validate checksum (optional in IPv4!)
    IF checksum enabled AND NOT validateChecksum(packet) THEN
        DROP packet
        RETURN
    END IF
    
    // 2. Find socket bound to this port
    socket = findSocket(packet.dstPort)
    IF socket == NULL THEN
        send_ICMP_port_unreachable()
        RETURN
    END IF
    
    // 3. Add to socket receive queue
    socket.receiveQueue.enqueue(packet.data)
    
    // 4. Wake up application if waiting
    wakeup_process(socket.waitingProcess)
END FUNCTION

KEY: No ordering, no buffering, no retry - just deliver!</code></pre>
                        </div>

                        <h4>üéØ Real-World Performance</h4>
                        <table class="comparison-table">
                            <thead>
                                <tr>
                                    <th>Metric</th>
                                    <th>TCP</th>
                                    <th>UDP</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>Latency (first byte)</strong></td>
                                    <td>~40ms (1 RTT for handshake + data)</td>
                                    <td>~10ms (immediate send)</td>
                                </tr>
                                <tr>
                                    <td><strong>Throughput</strong></td>
                                    <td>Varies (congestion control limits)</td>
                                    <td>Full link speed (no limits)</td>
                                </tr>
                                <tr>
                                    <td><strong>CPU overhead</strong></td>
                                    <td>High (state management, timers, ACKs)</td>
                                    <td>Minimal (stateless)</td>
                                </tr>
                                <tr>
                                    <td><strong>Memory per connection</strong></td>
                                    <td>~4KB (TCB + buffers)</td>
                                    <td>~100 bytes (just socket)</td>
                                </tr>
                            </tbody>
                        </table>

                        <h4>üìä Real Examples</h4>
                        <ul>
                            <li><strong>TCP:</strong>
                                <ul>
                                    <li>HTTP/HTTPS: Web page must load completely</li>
                                    <li>SSH: Every keystroke must arrive</li>
                                    <li>Database connections: Queries can't be lost</li>
                                </ul>
                            </li>
                            <li><strong>UDP:</strong>
                                <ul>
                                    <li>Zoom/Skype: Drop video frame, not worth retrying</li>
                                    <li>Online gaming: Old position update is useless</li>
                                    <li>DNS: Timeout and retry at application level</li>
                                </ul>
                            </li>
                        </ul>

                        <h4>üí° Our Simulation vs Reality</h4>
                        <table class="comparison-table">
                            <thead>
                                <tr>
                                    <th>Aspect</th>
                                    <th>Our Simulation</th>
                                    <th>Real Implementation</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Send</td>
                                    <td>Manual WAIT() calls</td>
                                    <td>Asynchronous, interrupt-driven</td>
                                </tr>
                                <tr>
                                    <td>Loss Detection</td>
                                    <td>random() probability</td>
                                    <td>Timer expiration (RTO)</td>
                                </tr>
                                <tr>
                                    <td>Processing</td>
                                    <td>Synchronous function calls</td>
                                    <td>Hardware interrupts, kernel threads</td>
                                </tr>
                                <tr>
                                    <td>Location</td>
                                    <td>Application-level simulation</td>
                                    <td>OS kernel (ring 0)</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script src="../../session.js"></script>
    <script src="../../theme.js"></script>
    <script src="app.js" defer></script>
</body>
</html>

